CREATE TABLE IF NOT EXISTS users
(
	ID int PRIMARY KEY AUTO_INCREMENT,
	identifier CHAR(64) NOT NULL UNIQUE,
	username VARCHAR(32) NOT NULL UNIQUE
);

CREATE TABLE IF NOT EXISTS recipes(
	ID int PRIMARY KEY AUTO_INCREMENT,
	title VARCHAR(32) NOT NULL,
	description VARCHAR(500),
	image_url VARCHAR(255) NOT NULL,
	ingredient_json VARCHAR(500) NOT NULL,
	views int DEFAULT 0,
	owner int NOT NULL,

	FOREIGN KEY(owner) REFERENCES users(ID) ON DELETE CASCADE
);

CREATE TABLE IF NOT EXISTS saved_recipes(
	ID int PRIMARY KEY AUTO_INCREMENT,
	user_id int NOT NULL,
	recipe_id int NOT NULL,

	FOREIGN KEY(user_id) REFERENCES users(ID) ON DELETE CASCADE,
	FOREIGN KEY(recipe_id) REFERENCES recipes(ID) ON DELETE CASCADE,

	UNIQUE(user_id, recipe_id)
);